Main functions should read as a sequence of well-named steps; extract the "how" into helpers.
