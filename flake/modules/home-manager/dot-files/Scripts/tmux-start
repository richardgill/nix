#!/usr/bin/env bash

if ! tmux list-sessions &>/dev/null; then
  # Temp session to bootstrap server + load config
  tmux new-session -d -s _temp
  # Restore saved sessions
  tmux run-shell "$(tmux show-option -gqv @resurrect-restore-script-path)"
fi

# Ensure "code" exists
tmux has-session -t code 2>/dev/null || tmux new-session -d -s code -c ~/code

# Clean up temp session
tmux kill-session -t _temp 2>/dev/null

# The fallback should never trigger since "code" is created above
~/Scripts/tmux-last || tmux new -s code -c ~/code
